<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.movieport.mapper.MovieMapper">

	<!-- 영화 리스트 -->
	<select id="moviesGetList"
		resultType="com.movieport.model.MovieVO">
		<![CDATA[

			select m_code, title, runtime, thumb, content, totalrate, likes, hits, showdate, type, trailer, ranking, adult, image, genres, language, original_title, popularity, video, rate_count  from(
				select /*+INDEX_DESC(movie SYS_C008375) */
					rownum as rn, m_code, title, runtime, thumb, content, totalrate, likes, hits, showdate, type, trailer, ranking, adult, image, genres, language, original_title, popularity, video, rate_count 
				from movie 	
				where
		]]>

		<if test="keyword != null">
			title like '%'||#{keyword}||'%' and
		</if>
		
		<![CDATA[
				rownum <= #{pageNum}*#{amount}
            	)
        	where rn > (#{pageNum} - 1) * #{amount}
		]]>

	</select>
	
	<!-- 작가 수 -->
	<select id="movieGetTotal" resultType="int">
	
		select count(*) from movie
		
		<if test="keyword != null">
			where title like '%' || #{keyword} || '%'
		</if>
	
	</select>
	
	<!-- 영화 상세 -->
	<select id="movieGetDetail" >
		select * from movie where m_code = #{m_code}
	</select>
	
	<!-- 영화코드, 영화이름 불러오기 -->
	<select id="movieGetCodeTitle" >
		select m_code, title from movie where m_code = #{m_code}
	</select>
	
	
</mapper>